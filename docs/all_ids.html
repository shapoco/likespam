<!DOCTYPE html>
<html lang="ja">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">

    <meta name="keywords" content="X,Twitter,いいねスパム,公式スパム">
    <meta name="description" content="X で「いいね」を送りつけてくるスパムの一覧">

    <meta property="og:url" content="https://shapoco.github.io/likespam/" />
    <meta property="og:title" content="いいねスパム一覧" />
    <meta property="og:description" content="X で「いいね」を送りつけてくるスパムの一覧" />
    <meta property="og:image" content="https://shapoco.github.io/likespam/card.png" />

    <!-- <link rel="icon" href="/likespam/favicon192.png" sizes="192x192"> -->
    <!-- <link rel="apple-touch-icon" href="/likespam/apple-touch-icon180.png" sizes="180x180"> -->
    <link rel="shortcut icon" href="/likespam/favicon48.ico">

    <title>いいねスパム一覧</title>
    <script src="./database.js?t"></script>
    <link href="./style.css?q" rel="stylesheet" type="text/css">
  </head>

  <body>
    <div class="header"><img src="cover.png"></div>
    <h1>いいねスパム一覧</h1>

    <ul>
      <li><a href="https://github.com/shapoco/likespam" target="_blank">この表について（質問・要望等を送る前にお読み下さい）</a></li>
      <li>灰色の行は凍結済みのアカウントです。</li>
      <li><strong>短時間に大量のアカウントをブロックすると強制ログアウトされる場合があるそうなので、全部をブロックしようとは思わない方が良さそうです。</strong></li>
      <li><a href="https://docs.google.com/forms/d/1JA81ejw4HB_zXXYVz-2ewMiRTLgurQIcNIbxR0JBRAQ">スパムアカウントの追加依頼はこちら (Google Forms)。</a></li>
      <li><a href="https://x.com/hashtag/%E3%81%84%E3%81%84%E3%81%AD%E3%82%B9%E3%83%91%E3%83%A0?src=hashtag_click&f=live">#いいねスパムタグ</a> の投稿も拾うかもしれません。</li>
      <li><a href="./">20件ずつのグループ化版はこちら</a></li>
    </ul>

    <p id="status"></p>
    
    <table id="spam_table">
      <tr>
        <th>#</th>
        <th>ID (screen_name)</th>
        <th>追加日</th>
      </tr>
    </table>

    <script>
      function main() {
        now = Date.now();
        tbl = document.getElementById('spam_table');
        var num_frozen = 0;
        for (var i = spam_items.length - 1; i >= 0; i--) {
          const spam = spam_items[i];
          const is_frozen = new Date(spam.frozen_date) < now;
          if (is_frozen) num_frozen += 1;
          const name_html = '<a href="https://x.com/' + spam.screen_name + '" target="_blank">@' + spam.screen_name+ '</a>';
          td_num = document.createElement('td'); 
          td_id = document.createElement('td');
          td_added = document.createElement('td');
          td_num.innerHTML = (i + 1).toString();
          td_id.innerHTML = name_html;
          td_added.innerHTML = formatDate(new Date(spam.added_date));
          tr = document.createElement('tr');
          if (is_frozen) {
            tr.classList.add("frozen");
          }
          tr.appendChild(td_num);
          tr.appendChild(td_id);
          tr.appendChild(td_added);
          tbl.appendChild(tr);
        }
        document.getElementById('status').innerHTML = spam_items.length + '件のスパム, ' + num_frozen + '件凍結確認済';
      }

      function formatDate(d) {
        const now = new Date();
        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        const yesterday = new Date(today);
        yesterday.setDate(today.getDate() - 1);

        const isToday = d >= today && d < new Date(today.getTime() + 24 * 60 * 60 * 1000);
        const isYesterday = d >= yesterday && d < today;
        const isThisYear = d.getFullYear() === now.getFullYear();

        const hours = d.getHours().toString().padStart(2, '0');
        const minutes = d.getMinutes().toString().padStart(2, '0');

        if (isToday) {
          return `今日 ${hours}:${minutes}`;
        } else if (isYesterday) {
          return `昨日 ${hours}:${minutes}`;
        } else if (isThisYear) {
          const month = (d.getMonth() + 1);
          const day = d.getDate().toString().padStart(2, '0');
          return `${month}/${day} ${hours}:${minutes}`;
        } else {
          const year = d.getFullYear().toString().slice(-2);
          const month = (d.getMonth() + 1);
          const day = d.getDate().toString().padStart(2, '0');
          return `${year}/${month}/${day} ${hours}:${minutes}`;
        }
      }

      main();
    </script>

  </body>

</html>