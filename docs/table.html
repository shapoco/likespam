<!DOCTYPE html>
<html lang="ja">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">

    <meta name="keywords" content="X,Twitter,ã„ã„ã­ã‚¹ãƒ‘ãƒ ,å…¬å¼ã‚¹ãƒ‘ãƒ ">
    <meta name="description" content="X ã§ã€Œã„ã„ã­ã€ã‚’é€ã‚Šã¤ã‘ã¦ãã‚‹ã‚¹ãƒ‘ãƒ ã®ä¸€è¦§">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@shapoco" />
    <meta property="og:url" content="https://shapoco.github.io/likespam/" />
    <meta property="og:title" content="ã„ã„ã­ã‚¹ãƒ‘ãƒ ä¸€è¦§" />
    <meta property="og:description" content="X ã§ã€Œã„ã„ã­ã€ã‚’é€ã‚Šã¤ã‘ã¦ãã‚‹ã‚¹ãƒ‘ãƒ ã®ä¸€è¦§" />
    <meta property="og:image" content="https://shapoco.github.io/likespam/card_large.png" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BMDGFGR0Z4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-BMDGFGR0Z4');
    </script>

    <!-- <link rel="icon" href="/likespam/favicon192.png" sizes="192x192"> -->
    <!-- <link rel="apple-touch-icon" href="/likespam/apple-touch-icon180.png" sizes="180x180"> -->
    <link rel="shortcut icon" href="/likespam/favicon48.ico">

    <title>PCç”¨ä¸€è¦§ | ã„ã„ã­ã‚¹ãƒ‘ãƒ ä¸€è¦§</title>
    <link href="./style.css?20240927121153" rel="stylesheet" type="text/css">
    <script src="./index.js?20240927121153"></script>
    <script src="./database.js?20240927101434"></script>
  </head>

  <body>
    <div class="header"><img src="cover.png"></div>
    <div class="author">
      ç®¡ç†è€…: <a href="https://x.com/syego" target="_blank">@syego</a>
    </div>
    <p id="menu"></p>
    <script>likeSpamRenderMenu(1);</script>
    
    <h1>ã„ã„ã­ã‚¹ãƒ‘ãƒ ä¸€è¦§ (PCç”¨ä¸€è¦§)</h1>

    <p>
      ã‚¹ãƒãƒ›ç­‰ã§ 1 ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãšã¤é–‹ãã®ãŒé¢å€’ãªå ´åˆã¯ 20 ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãšã¤ã«ã¾ã¨ã¾ã£ãŸ <a href="./">ã‚°ãƒ«ãƒ¼ãƒ—å½¢å¼ç‰ˆ</a> ã‚’ã”è¦§ä¸‹ã•ã„ã€‚
    </p>

    <div id="stats"></div>
    <script>likeSpamRenderStats();</script>

    <ul>
      <li><del>æ‰“ã¡æ¶ˆã—ç·š</del>: å‡çµç¢ºèªæ¸ˆ (<del class="frozen_new">æ°´è‰²</del>: éå»24æ™‚é–“ä»¥å†…ã«å‡çµç¢ºèª)</li>
      <li><span class="rpspam">ç·‘è‰²</span> : ãƒªãƒã‚¹ãƒˆã‚¹ãƒ‘ãƒ  (æ´»å‹•åœæ­¢ä¸­ã€‚ç¾çŠ¶ã¯ç„¡è¦–ã—ã¦ã„ã„ã¨æ€ã„ã¾ã™)</li>
    </ul>
    
    <div id="table_size_warning" style="display: none;">
      <p>
        <strong>
          ã‚¹ãƒ‘ãƒ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ•°ãŒéå¸¸ã«å¤šããªã£ã¦ã„ã‚‹ãŸã‚ã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã¯è¡¨ãŒå¤§ãã™ãã¦ãƒ–ãƒ©ã‚¦ã‚¶ã®å‹•ä½œãŒä¸å®‰å®šã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
        </strong>
      </p>
      <p>
        <a href="javascript:generateTable();">è¡¨ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</a>
      </p>
    </div>

    <p>
      ãƒšãƒ¼ã‚¸: <span id="page_links_top"></span>
    </p>
    <table id="spam_table">
      <tr>
        <th>#</th>
        <th>è¿½åŠ æ—¥</th>
        <th>screen_name</th>
        <th>user_id</th>
        <th>name</th>
      </tr>
    </table>
    <p>
      ãƒšãƒ¼ã‚¸: <span id="page_links_bottom"></span>
    </p>

    <script>
      const LIKESPAM_ITEMS_PER_PAGE = 500;

      function likeSpamOpenPage(ipage) {
        window.location = './table.html#page' + ipage;
        likeSpamRenderTable();
      }
      
      history.replaceState(null, null, null);
      window.addEventListener('popstate', function(e) {
        likeSpamRenderTable();
      });

      function likeSpamGetPageIndex() {
        const urlRegex = /#page(\d+)$/;
        const url = window.location.href;
        const m = url.match(urlRegex);
        var query = {};
        if (m) {
          query.page = m[1];
        }
        else {
          query.page = 0;
        }
        return query;
      }

      function likeSpamGenPageLinks() {
        const query = likeSpamGetPageIndex();
        const numPages = Math.ceil(likeSpams.length / LIKESPAM_ITEMS_PER_PAGE);
        //const ipageFrom = isSmartPhone() ? 0 : -1;
        const ipageFrom = 0;
        var html = '';
        for(var ipage = ipageFrom; ipage < numPages; ipage++) {
          const text = ipage < 0 ? 'å…¨ã¦' : (ipage + 1).toString();
          if (ipage == query.page) {
            html += `<span class="menu_item menu_selected">${text}</span> `;
          }
          else {
            html += `<a class="menu_item" href="javascript: likeSpamOpenPage(${ipage})">${text}</a> `;
          }
        }
        
        document.getElementById('page_links_top').innerHTML = html;
        document.getElementById('page_links_bottom').innerHTML = html;
      }

      function likeSpamRenderTable() {
        likeSpamGenPageLinks();

        const query = likeSpamGetPageIndex();
        const ipage = query.page == 'all' ? -1 : parseInt(query.page);

        const numSpam = likeSpams.length;
        var ifrom = numSpam - 1;
        var ito = 0;
        if (ipage >= 0) {
          ifrom = (numSpam - 1) - ipage * LIKESPAM_ITEMS_PER_PAGE;
          ito = Math.max(0, ifrom - LIKESPAM_ITEMS_PER_PAGE + 1);
        }
        
        const now = Date.now();
        var html = '<th>#</th><th>è¿½åŠ æ—¥</th><th>screen_name</th><th>user_id</th><th>name</th>';
        for (var ispam = ifrom; ispam >= ito; ispam--) {
          const spam = likeSpams[ispam];
          const isFrozen = !!(spam.frozenDate);
          const isNewFrozen = isFrozen && (now - spam.frozenDate) < 1000 * 60 * 60 * 24;
          const userIdHtml = spam.userId.length > 0 ? '<a href="https://x.com/i/user/' + spam.userId + '" target="_blank">' + spam.userId + '</a>' : '';
          const scrNameHtml = '<a href="https://x.com/' + spam.screenName + '" target="_blank">@' + spam.screenName + '</a>';
          //var icon_html = '<span id="status_icon_' + i + '" onMouseOver="javascript: checkProfileIconExistence(' + i + ')">' + STATUS_ICON_UNKNOWN + '</span>';

          if (isNewFrozen) {
            html += '<tr class="frozen frozen_new">';
          }
          else if (isFrozen) {
            html += '<tr class="frozen">';
          }
          else if (spam.name.includes('ãƒªãƒã‚¹ãƒˆã•ã‚ŒãŸã‚‰ãŠã‚ã§ã¨ã†')) {
            html += '<tr class="rpspam">';
          }
          else {
            html += '<tr>';
          }
          html += `<td>${ispam + 1}</td>`;
          html += `<td>${likeSpamFormatDate(spam.addedDate)}</td>`;
          html += `<td>${scrNameHtml}</td>`;
          html += `<td>${userIdHtml}</td>`;
          html += `<td>${spam.name}</td>`;
          html += '</tr>';
        }

        document.getElementById('spam_table').innerHTML = html;
      }

      likeSpamRenderTable();
    </script>

    <script>
      const STATUS_ICON_UNKNOWN = 'âšª';
      const STATUS_ICON_CHECKING = 'ğŸŸ¡';
      const STATUS_ICON_SUCCESS = 'ğŸŸ¢';
      const STATUS_ICON_FAILED = 'ğŸ”´';

      function main() {
        //if (isSmartPhone()) {
        //  document.getElementById('table_size_warning').style.display = 'block';
        //}
        //else {
        //  generateTable();
        //}
      }

      function generateTable() {
        document.getElementById('table_size_warning').style.display = 'none';

        now = Date.now();
        tbl = document.getElementById('spam_table');
        const num_spam = likeSpams.length;
        for (var i = num_spam - 1; i >= 0; i--) {
          const spam = likeSpams[i];
          const isFrozen = !!(spam.frozenDate);
          const isNewFrozen = isFrozen && (now - spam.frozenDate) < 1000 * 60 * 60 * 24;
          const userIdHtml = spam.userId.length > 0 ? '<a href="https://x.com/i/user/' + spam.userId + '" target="_blank">' + spam.userId + '</a>' : '';
          const scrNameHtml = '<a href="https://x.com/' + spam.screenName + '" target="_blank">@' + spam.screenName + '</a>';
          //var icon_html = '<span id="status_icon_' + i + '" onMouseOver="javascript: checkProfileIconExistence(' + i + ')">' + STATUS_ICON_UNKNOWN + '</span>';
          const td_num = document.createElement('td'); 
          const td_added = document.createElement('td');
          const td_scrname = document.createElement('td');
          const td_uesrid = document.createElement('td');
          const td_name = document.createElement('td');
          td_num.innerHTML = (i + 1).toString();
          td_added.innerHTML = likeSpamFormatDate(spam.addedDate);
          td_scrname.innerHTML = scrNameHtml;
          td_uesrid.innerHTML = userIdHtml;
          //td_name.innerHTML = icon_html + ' ' + spam.name;
          td_name.innerHTML = spam.name;
          tr = document.createElement('tr');
          if (isFrozen) {
            tr.classList.add("frozen");
            if (isNewFrozen) {
              tr.classList.add("frozen_new");
            }
          }
          else if (spam.name.includes('ãƒªãƒã‚¹ãƒˆã•ã‚ŒãŸã‚‰ãŠã‚ã§ã¨ã†')) {
            tr.classList.add("rpspam");
          }
          tr.appendChild(td_num);
          tr.appendChild(td_added);
          tr.appendChild(td_scrname);
          tr.appendChild(td_uesrid);
          tr.appendChild(td_name);
          tbl.appendChild(tr);
        }
      }

      function checkProfileIconExistence(index) {
        const span = document.getElementById('status_icon_' + index);
        if (span.innerHTML != STATUS_ICON_UNKNOWN) return;
        span.innerHTML = STATUS_ICON_CHECKING;
        const url = likeSpams[index].profile_image_url;
        checkIfImageExists(index, url)
          .then((index, url) => {
              //console.log(`Image found: ${index}`);
              span.innerHTML = STATUS_ICON_SUCCESS;
          })
          .catch((index, url) => {
              //console.log(`Image not found: ${index}`);
              span.innerHTML = STATUS_ICON_FAILED;
          });
      }

      function checkIfImageExists(index, url) {
        return new Promise((resolve, reject) => {
          const img = new Image();
          img.src = url;
          img.onload = () => resolve(index, url);
          img.onerror = () => reject(index, url);
        });
      }

      main();
    </script>

    <hr>
  </body>

</html>